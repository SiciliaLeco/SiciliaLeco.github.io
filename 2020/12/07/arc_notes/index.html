<!DOCTYPE html>
<html lang="en">
    <!-- title -->


    

<!-- keywords -->



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="Sicilia Lee (李颀琳）">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Sicilia Lee (李颀琳）">
    
        <meta name="keywords" content="hexo,hexo-theme,hexo-blog">
    
    <meta name="description" content="">
    <meta name="description" content="Computer Architecture Course ReviewLI QILIN @ CQU, Fall, 2020 Leture 01. Quantitative Approach1.1 Power And Energy1.1.1 introduction1.Thermal Design Power(TDP): Lower than peak power, higher than aver">
<meta property="og:type" content="article">
<meta property="og:title" content="2020秋季《计算机体系结构》笔记">
<meta property="og:url" content="http://example.com/2020/12/07/arc_notes/index.html">
<meta property="og:site_name" content="Sicilia Lee&#39;s blog">
<meta property="og:description" content="Computer Architecture Course ReviewLI QILIN @ CQU, Fall, 2020 Leture 01. Quantitative Approach1.1 Power And Energy1.1.1 introduction1.Thermal Design Power(TDP): Lower than peak power, higher than aver">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201207093805956.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201207095046112.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201207104233012.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201207111224921.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201207112207854.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201207112306311.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201207113849175.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201207113633122.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201207153730999.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201207210159451.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201207210942981.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201208091500097.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201208112748770.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201208094940662.png">
<meta property="og:image" content="http://example.com/Users/liqilin/Library/Application%20Support/typora-user-images/image-20201208171544187.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201208173455175.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201208173630145.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201208193842341.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201208193922573.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/image-20201208205949463.png">
<meta property="og:image" content="http://example.com/2020/12/07/arc_notes/arc_notesimage-20201208214021425.png">
<meta property="article:published_time" content="2020-12-07T03:32:26.000Z">
<meta property="article:modified_time" content="2022-01-10T03:32:19.563Z">
<meta property="article:author" content="Sicilia Lee (李颀琳）">
<meta property="article:tag" content="Computer Architecture">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2020/12/07/arc_notes/image-20201207093805956.png">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="icon" href="/assets/favicon.jpeg">
    
    <title>2020秋季《计算机体系结构》笔记 · Sicilia&#39;s Studio</title>
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
    (function (w) {
        'use strict'
        // rel=preload support test
        if (!w.loadCSS) {
            w.loadCSS = function () {}
        }
        // define on the loadCSS obj
        var rp = (loadCSS.relpreload = {})
        // rel=preload feature support test
        // runs once and returns a function for compat purposes
        rp.support = (function () {
            var ret
            try {
                ret = w.document.createElement('link').relList.supports('preload')
            } catch (e) {
                ret = false
            }
            return function () {
                return ret
            }
        })()

        // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
        // then change that media back to its intended value on load
        rp.bindMediaToggle = function (link) {
            // remember existing media attr for ultimate state, or default to 'all'
            var finalMedia = link.media || 'all'

            function enableStylesheet() {
                link.media = finalMedia
            }

            // bind load handlers to enable media
            if (link.addEventListener) {
                link.addEventListener('load', enableStylesheet)
            } else if (link.attachEvent) {
                link.attachEvent('onload', enableStylesheet)
            }

            // Set rel and non-applicable media type to start an async request
            // note: timeout allows this to happen async to let rendering continue in IE
            setTimeout(function () {
                link.rel = 'stylesheet'
                link.media = 'only x'
            })
            // also enable media after 3 seconds,
            // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
            setTimeout(enableStylesheet, 3000)
        }

        // loop through link elements in DOM
        rp.poly = function () {
            // double check this to prevent external calls from running
            if (rp.support()) {
                return
            }
            var links = w.document.getElementsByTagName('link')
            for (var i = 0; i < links.length; i++) {
                var link = links[i]
                // qualify links to those with rel=preload and as=style attrs
                if (
                    link.rel === 'preload' &&
                    link.getAttribute('as') === 'style' &&
                    !link.getAttribute('data-loadcss')
                ) {
                    // prevent rerunning on link
                    link.setAttribute('data-loadcss', true)
                    // bind listeners to toggle media back
                    rp.bindMediaToggle(link)
                }
            }
        }

        // if unsupported, run the polyfill
        if (!rp.support()) {
            // run once at least
            rp.poly()

            // rerun poly on an interval until onload
            var run = w.setInterval(rp.poly, 500)
            if (w.addEventListener) {
                w.addEventListener('load', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            } else if (w.attachEvent) {
                w.attachEvent('onload', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            }
        }

        // commonjs
        if (typeof exports !== 'undefined') {
            exports.loadCSS = loadCSS
        } else {
            w.loadCSS = loadCSS
        }
    })(typeof global !== 'undefined' ? global : this)
</script>

    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }
</style>

    <link rel="preload" href="/css/style.css?v=20211217" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/css/dark.css?v=20211217" as="style">
    <link rel="stylesheet" href="/css/dark.css">
    <link rel="stylesheet" href="/css/mobile.css?v=20211217" media="(max-width: 960px)">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js?v=20211217" as="script">
    <link rel="preload" href="/scripts/dark.js?v=20211217" as="script">
    <link rel="preload" href="/font/Oswald-Regular.ttf" as="font" crossorigin>
    <link rel="preload" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" as="font" crossorigin>
    <!-- algolia -->
    
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="Sicilia Lee's blog" type="application/atom+xml">
</head>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ == undefined) {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js" />')
        }
    </script>
    
        <body class="post-body">
    
        <!-- header -->
        <header class="header header-mobile">
    <!-- top read progress line -->
    <div class="header-element">
        <div class="read-progress"></div>
    </div>
    <!-- sidebar menu button -->
    <div class="header-element">
        
            <div class="header-sidebar-menu">
        
            
                <div style="padding-left: 1px;">&#xe775;</div>
            
        </div>
    </div>
    <!-- header actions -->
    <div class="header-actions">
        <!-- theme mode switch button -->
        <span class="header-theme-btn header-element">
            <i class="fas fa-adjust"></i>
        </span>
        <!-- back to home page text -->
        <span class="home-link header-element">
            <a href=/>Sicilia's Studio</a>
        </span>
    </div>
    <!-- toggle banner for post layout -->
    
        
            <div class="banner">
        
            <div class="blog-title header-element">
                <a href="/">Sicilia&#39;s Studio</a>
            </div>
            <div class="post-title header-element">
                <a href="#" class="post-name">2020秋季《计算机体系结构》笔记</a>
            </div>
        </div>
    
</header>

        <!-- fixed footer -->
        <footer class="footer-fixed">
    <!-- back to top button -->
    <div class="footer-fixed-element">
        
            <div class="back-top back-top-hidden">
        
        
            <div>&#xe639;</div>
        
        </div>
    </div>
</footer>

        <!-- wrapper -->
        <div class="wrapper">
            <div class="site-intro" style="







    height:50vh;

">
    
    <!-- 主页  -->
    
        
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/bkgrd.png)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
                2020秋季《计算机体系结构》笔记
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
                
            <!-- 404 -->
            
        </p>
        <!-- 文章页 meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
    
        <a class="post-tag" href="javascript:void(0);" data-tags="Computer Architecture">Computer Architecture</a>
    
</div>

                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count word-count">4.5k</span>Reading time: <span class="post-count reading-time">23 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <!-- 撰写日期 -->
                    <span class="iconfont-archer post-intro-calander">&#xe676;</span>
                    <span class="post-intro-time">2020/12/07</span>
                    <!-- busuanzi -->
                    
                        <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                            <span class="iconfont-archer post-intro-busuanzi">&#xe602;</span>
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    
                    <!-- 文章分享 -->
                    <span class="share-wrapper">
                        <span class="iconfont-archer share-icon">&#xe71d;</span>
                        <span class="share-text">Share</span>
                        <ul class="share-list">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>

            <script>
  // get user agent
  function getBrowserVersions() {
    var u = window.navigator.userAgent
    return {
      userAgent: u,
      trident: u.indexOf('Trident') > -1, //IE内核
      presto: u.indexOf('Presto') > -1, //opera内核
      webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
      gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
      mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
      ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
      android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
      iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
      iPad: u.indexOf('iPad') > -1, //是否为iPad
      webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
      weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
      uc: u.indexOf('UCBrowser') > -1, //是否为android下的UC浏览器
    }
  }
  var browser = {
    versions: getBrowserVersions(),
  }
  console.log('userAgent: ' + browser.versions.userAgent)

  // callback
  function fontLoaded() {
    console.log('font loaded')
    if (document.getElementsByClassName('site-intro-meta')) {
      document
        .getElementsByClassName('intro-title')[0]
        .classList.add('intro-fade-in')
      document
        .getElementsByClassName('intro-subtitle')[0]
        .classList.add('intro-fade-in')
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in')
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb() {
    if (browser.versions.uc) {
      console.log('UCBrowser')
      fontLoaded()
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular'],
        },
        loading: function () {
          // 所有字体开始加载
          // console.log('font loading');
        },
        active: function () {
          // 所有字体已渲染
          fontLoaded()
        },
        inactive: function () {
          // 字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout')
          fontLoaded()
        },
        timeout: 5000, // Set the timeout to two seconds
      })
    }
  }

  function asyncErr() {
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0]
    o.src = u
    if (cb) {
      o.addEventListener(
        'load',
        function (e) {
          cb(null, e)
        },
        false
      )
    }
    if (err) {
      o.addEventListener(
        'error',
        function (e) {
          err(null, e)
        },
        false
      )
    }
    s.parentNode.insertBefore(o, s)
  }

  var asyncLoadWithFallBack = function (arr, success, reject) {
    var currReject = function () {
      reject()
      arr.shift()
      if (arr.length) async(arr[0], success, currReject)
    }

    async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack(
    [
      'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js',
      'https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js',
      "/lib/webfontloader.min.js",
    ],
    asyncCb,
    asyncErr
  )
</script>

            <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
            <div class="container container-unloaded">
                <main class="main post-page">
    <article class="article-entry">
        <h2 id="Computer-Architecture-Course-Review"><a href="#Computer-Architecture-Course-Review" class="headerlink" title="Computer Architecture Course Review"></a>Computer Architecture Course Review</h2><p>LI QILIN @ CQU, Fall, 2020</p>
<h3 id="Leture-01-Quantitative-Approach"><a href="#Leture-01-Quantitative-Approach" class="headerlink" title="Leture 01. Quantitative Approach"></a>Leture 01. Quantitative Approach</h3><h4 id="1-1-Power-And-Energy"><a href="#1-1-Power-And-Energy" class="headerlink" title="1.1 Power And Energy"></a>1.1 Power And Energy</h4><h5 id="1-1-1-introduction"><a href="#1-1-1-introduction" class="headerlink" title="1.1.1 introduction"></a>1.1.1 introduction</h5><p>1.Thermal Design Power(TDP): Lower than peak power, higher than average power consumption.</p>
<p>2.Clock rate can be reduced dynamically to limit power consumption</p>
<p>3.功耗（power）、能耗（Energy），一般用<strong>Energy</strong>衡量处理器性能。</p>
<p>4.两种影响性能的power：dynamic、static.</p>
<blockquote>
<p>Dynamic power dissipated when transistors switch.(e.g: data dependent).<br>Static power is due to leakage current and proportional to the number of transistors on-chip.</p>
</blockquote>
<h5 id="1-1-2-dynamic-energy-and-power"><a href="#1-1-2-dynamic-energy-and-power" class="headerlink" title="1.1.2 dynamic energy and power"></a>1.1.2 dynamic energy and power</h5><p>1.Dynamic Energy:</p>
<p>Transistor switch from 0 -&gt; 1 -&gt; 0 or 1 -&gt; 0 -&gt; 1:</p>
<script type="math/tex; mode=display">
Energy_{dynamic} = CV^2</script><p>2.Dynamic Power:</p>
<script type="math/tex; mode=display">
Power_{dynamic}={1\over2}CV^2f</script><p><em>Reducing clock rate reduces power, not energy!</em></p>
<h4 id="1-2-Performance-Metrics"><a href="#1-2-Performance-Metrics" class="headerlink" title="1.2 Performance Metrics"></a>1.2 Performance Metrics</h4><p>1.Machine X is n times faster than machine Y:</p>
<p><img src="/2020/12/07/arc_notes/image-20201207093805956.png" alt="image-20201207093805956" style="zoom:30%;"></p>
<h4 id="1-3-Principle-of-Locality"><a href="#1-3-Principle-of-Locality" class="headerlink" title="1.3 Principle of Locality"></a>1.3 Principle of Locality</h4><p>1.Temporal Locality: again sometime in the near future.</p>
<p>2.Spatial Locality: a higher resource near it was just refe.</p>
<p>E.g:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i= <span class="number">0</span> ; i&lt; <span class="number">20</span> ; i++)</span><br><span class="line">	<span class="keyword">for</span>( j=<span class="number">0</span>; j&lt;<span class="number">10</span>; j++)</span><br><span class="line">		a[i]=a[i]*j;</span><br></pre></td></tr></table></figure>
<p>Spatial: 外层循环，下一次即将访问是a[i+1]，与a[i]在物理存储上是连续的；<br>Temporal：内层循环，下一次又要使用a[i]是之前使用过的数据。</p>
<h4 id="1-4-Amdahl’s-Law"><a href="#1-4-Amdahl’s-Law" class="headerlink" title="1.4 Amdahl’s Law"></a>1.4 Amdahl’s Law</h4><p>1.the OVERALL speedup:</p>
<p><img src="/2020/12/07/arc_notes/image-20201207095046112.png" alt="image-20201207095046112" style="zoom:37%;"></p>
<p>2.for component x is improved by Sx and affects a fraction Fx of the overall execution time:</p>
<script type="math/tex; mode=display">
speedup = {1\over (1-Fx) + Fx/Sx}</script><p>E.g:</p>
<blockquote>
<p>If we optimize the module for the floating-point instructions by a factor of 2, but the system will normally run programs with only 20% of floating point instructions then the speedup is :</p>
</blockquote>
<p><em>注：by a factor of X是指缩小成1/X倍</em></p>
<script type="math/tex; mode=display">
speedup = {1\over (1-20\%) + 20\%/2} = 1.111</script><h4 id="1-5-CPU-Time"><a href="#1-5-CPU-Time" class="headerlink" title="1.5 CPU Time"></a>1.5 CPU Time</h4><p>1.Classification:</p>
<blockquote>
<p>User CPU time: spent in the user program.</p>
<p>System CPU time: spent in the OS performing tasks required by the program</p>
</blockquote>
<p><strong>user CPU time is to assess CPU performance. (aka CPU time)</strong></p>
<p>2.Formula:</p>
<script type="math/tex; mode=display">
CPU \ time=CCP \times CCT=CCP / Frequency</script><p>3.Three Main Factors:</p>
<p>​    a. IC=instruction count, number of instructions executed for a program.</p>
<p>​    b. CPI=clock cycles per instruction, average number of clock cycles per instruction.</p>
<p>​    c. CCT=clock cycle time.</p>
<p> CPU Time equally depends on these three factors, and based on the above:</p>
<script type="math/tex; mode=display">
CPU \ time = IC\times CPI \times CCT</script><p><em>note: CPI越小越好，但是不一定1最好，因为超标量处理器一次可以issue多条，CPI&lt;1.</em></p>
<p>4.Dependencies:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>IC</th>
<th>CPI</th>
<th>CCT</th>
</tr>
</thead>
<tbody>
<tr>
<td>Program</td>
<td>✔️</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Compiler</td>
<td>✔️</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ISA</td>
<td>✔️</td>
<td>✔️</td>
<td></td>
</tr>
<tr>
<td>HW organization</td>
<td></td>
<td>✔️</td>
<td>✔️</td>
</tr>
<tr>
<td>HW technology</td>
<td></td>
<td></td>
<td>✔️</td>
</tr>
</tbody>
</table>
</div>
<p>E.g:</p>
<p><img src="/2020/12/07/arc_notes/image-20201207104233012.png" alt="image-20201207104233012" style="zoom:30%;"></p>
<script type="math/tex; mode=display">
CPI_{average}=4.0 \times 25\%+1.33\times 75\%=2.0</script><p>We can first calculate that CPI with FPSQR’s decrease is:</p>
<script type="math/tex; mode=display">
CPI_{new1} = 2.0 - 2\%\times(20-2)=1.64</script><p>So the speedup rate for FPSQR is:</p>
<script type="math/tex; mode=display">
speedup_1 = CPI_{average}/CPI_{new1}=</script><p>While for decrease in FP, new CPI is:</p>
<script type="math/tex; mode=display">
CPI_{new2}=25\%\times2.5+75\%\times1.33=1.625</script><p>So the speedup rate for FP is:</p>
<script type="math/tex; mode=display">
speedup_2=CPI_{average}/CPI_{new2}=</script><h3 id="Lecture02-Instruction-Set-Architecture"><a href="#Lecture02-Instruction-Set-Architecture" class="headerlink" title="Lecture02. Instruction Set Architecture"></a>Lecture02. Instruction Set Architecture</h3><h4 id="2-1-Operand-Storage"><a href="#2-1-Operand-Storage" class="headerlink" title="2.1 Operand Storage"></a>2.1 Operand Storage</h4><p>​    a. Memory: Need to represent the address with a few bits.</p>
<p>​    b. Register: Short register addressing, AC</p>
<p>​    c. Stack : Does not need for addresses.</p>
<p><em>Whatever the ISA, operand’s address needs to be mapped into an Effective Address of the physical storage location!</em></p>
<h4 id="2-2-Kinds-of-Addressing-Mode"><a href="#2-2-Kinds-of-Addressing-Mode" class="headerlink" title="2.2 Kinds of Addressing Mode"></a>2.2 Kinds of Addressing Mode</h4><p><img src="/2020/12/07/arc_notes/image-20201207111224921.png" alt="image-20201207111224921" style="zoom:33%;"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Addressing Mode</th>
<th>value</th>
<th>Addressing Mode</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Register direct</td>
<td>[Ri]</td>
<td>Scaled Index</td>
<td>M[[Ri] + [Rj]*d + v], eg. d=8</td>
</tr>
<tr>
<td>Immediate (literal)</td>
<td>v</td>
<td>Autoincrement</td>
<td>M[[Ri] + 1]</td>
</tr>
<tr>
<td>Direct (absolute)</td>
<td>M[Ri]</td>
<td>Autodecrement</td>
<td>M[[Ri] - 1]</td>
</tr>
<tr>
<td>Register indirect</td>
<td>M[[Ri]]</td>
<td>Memory Indirect</td>
<td>M[M[Ri]]</td>
</tr>
<tr>
<td>Base+Displacement</td>
<td>M[[Ri] + v]</td>
<td>Base+Index</td>
<td>M[[Ri] + [Rj]]</td>
</tr>
</tbody>
</table>
</div>
<p>note: M is memory, R is register, [] get the value in it.</p>
<p>the following figure show the mode of finding addr’s value:</p>
<p><img src="/2020/12/07/arc_notes/image-20201207112207854.png" alt="image-20201207112207854" style="zoom:33%;"></p>
<p><img src="/2020/12/07/arc_notes/image-20201207112306311.png" alt="image-20201207112306311" style="zoom:30%;"></p>
<h4 id="2-3-MIPS"><a href="#2-3-MIPS" class="headerlink" title="2.3 MIPS"></a>2.3 MIPS</h4><h5 id="2-3-1-Overview"><a href="#2-3-1-Overview" class="headerlink" title="2.3.1 Overview"></a>2.3.1 Overview</h5><p>1.Architecture: Register-to-Register (load-store)</p>
<p>2.Addressing modes:</p>
<ul>
<li>displacement (offset: 12 ~ 16 bits)</li>
<li>using PC-relative addressing, branch +/- 2^15 words from PC.</li>
<li>immediate (size 8-16 bits)</li>
<li>register indirect</li>
</ul>
<p>3.Data size &amp; type: Integers (8,16,32,64 size) and FP (64)</p>
<p>E.g: fill in the blanks of mode.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>instruction</th>
<th>meaning</th>
<th>mode</th>
</tr>
</thead>
<tbody>
<tr>
<td>DADDI R3, R2, 7</td>
<td>R3 &lt;- [R2] + 7</td>
<td>immediate</td>
</tr>
<tr>
<td>LD R3, 100(R1)</td>
<td>R3 &lt;- M[[R1] + 100]</td>
<td>displacement</td>
</tr>
<tr>
<td>LD R3, 0(R1)</td>
<td>R3 &lt;- M[[R1]]</td>
<td>register indirect</td>
</tr>
<tr>
<td>LD R3, 1001(R0)</td>
<td>R3 &lt;- M[1001]</td>
<td>direct addressing</td>
</tr>
</tbody>
</table>
</div>
<p>注：第四条寄存器用的R0，里面存放的数值固定为0，所以这就是基地址为0的寻址了，叫做直接寻址，与第二条区分开。</p>
<h5 id="2-3-2-Instruction-format"><a href="#2-3-2-Instruction-format" class="headerlink" title="2.3.2 Instruction format"></a>2.3.2 Instruction format</h5><p><img src="/2020/12/07/arc_notes/image-20201207113849175.png" alt="image-20201207113849175"></p>
<p>Load：Memory(Reg(j)) ———-&gt; Reg(i)</p>
<p>Store: Reg’s value(i) ———&gt; Memory(Reg(j)) (寄存器对应指令，不要写反了)</p>
<p>E.g: write mips code</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Loop: add $t1, $s3, $s3    #starts from 80000</span><br><span class="line">			add $t1, $t1, $t1</span><br><span class="line">			add $t1, $t1, $s6</span><br><span class="line">			lw  $t0, 0($t1)</span><br><span class="line">			bne $t0, $s5, Exit</span><br><span class="line">			add $s3, $s3, $s4</span><br><span class="line">			j   Loop</span><br><span class="line">Exit:</span><br></pre></td></tr></table></figure>
<p>(1)  |  add  | s3 | s3 | t1 | 0 |   32   |</p>
<p>(2)  |  add  | t1 | t1 | t1 | 0 |   32   |</p>
<p>(3)  |  add  | t1 | t6 | t1 | 0 |   32   |</p>
<p>(4)  |   lw    | t1 | t0 |         0          |</p>
<p>(5)  |  bne  | t0 | s5 |         <strong>2</strong>          |</p>
<p>(6)  |  add  | s3 | s4 | s3 | 0 |   32   |</p>
<p>(7)  |    j     |            <strong>20000</strong>             |</p>
<p>Note: MIPS uses bytes address, not word. in the instruction, write pseudodirect address (word addr)</p>
<h5 id="2-3-3-MIPS-addressing-mode"><a href="#2-3-3-MIPS-addressing-mode" class="headerlink" title="2.3.3 MIPS addressing mode"></a>2.3.3 MIPS addressing mode</h5><ul>
<li>Immediate: ADDI R3, R2, #7</li>
<li>displacement: LD R3, 1001(R1) </li>
<li>direct: LD R3, 100(R0)</li>
<li>indirect: LD R3, 0(R3)</li>
</ul>
<h4 id="2-4-Interpreting-Memory-Addressing"><a href="#2-4-Interpreting-Memory-Addressing" class="headerlink" title="2.4 Interpreting Memory Addressing"></a>2.4 Interpreting Memory Addressing</h4><p><img src="/2020/12/07/arc_notes/image-20201207113633122.png" alt="image-20201207113633122" style="zoom:40%;"></p>
<p>note: Memory <strong>word</strong> is addressed by the <strong>byte</strong> at the lowest address.</p>
<h3 id="Lecture-03-Pipelining"><a href="#Lecture-03-Pipelining" class="headerlink" title="Lecture 03. Pipelining"></a>Lecture 03. Pipelining</h3><h4 id="3-1-Pipelining-processing"><a href="#3-1-Pipelining-processing" class="headerlink" title="3.1 Pipelining processing"></a>3.1 Pipelining processing</h4><ol>
<li>Instruction fetch (IF)</li>
<li><p>Instruction decode and register operand fetch (ID/RF)</p>
</li>
<li><p>Execute/Evaluate memory address (EX/AG)</p>
</li>
<li><p>Memory operand fetch (MEM)</p>
</li>
<li><p>Store/writeback result (WB) </p>
</li>
</ol>
<blockquote>
<p>note: 1. Pipelining doesn’t help latency of <strong>single</strong> task, it helps throughput of entire workload.</p>
<p>2.Pipeline rate limited by slowest pipeline stage.</p>
<p>3.Unbalanced lengths of pipe stages reduces speedup.</p>
<p>4.Time to “fill” pipeline and time to “drain” it reduces speedup.</p>
</blockquote>
<h4 id="3-2-Design-Issues"><a href="#3-2-Design-Issues" class="headerlink" title="3.2 Design Issues"></a>3.2 Design Issues</h4><p>IDEAL:</p>
<p><img src="/2020/12/07/arc_notes/image-20201207153730999.png" alt="image-20201207153730999" style="zoom:33%;"></p>
<h5 id="3-2-1-Performance-issue"><a href="#3-2-1-Performance-issue" class="headerlink" title="3.2.1 Performance issue"></a>3.2.1 Performance issue</h5><p>(1)  Pipelining can be seen as either:</p>
<ul>
<li>decreasing the CPI of a multi-cycle un-pipelined implementation;</li>
<li>decreasing the CCT of a single-cycle un-pipelined implementation.</li>
</ul>
<p>理解：流水线对性能的提升体现在不同的情景下，其中降CPI是多指令中体现，降CCT是单条指令中体现出来的。降CCT其实就是降主频，un-pipelined的上升沿要做的事情比较多，但pipeline划分成一个上升沿只干一件事，就比无流水线的时钟长度短。</p>
<p>(2) with STALLS:</p>
<script type="math/tex; mode=display">
Speedup={CPI\ unpipelined\over 1+pipeline\ stall \ cycle \ per \ instruction }={CPI\ depth\over 1+pipeline\ stall \ cycle \ per \ instruction }</script><h5 id="3-2-2-Performance-Limitation"><a href="#3-2-2-Performance-Limitation" class="headerlink" title="3.2.2 Performance Limitation"></a>3.2.2 Performance Limitation</h5><ul>
<li>Imbalance among pipe stages : limits cycle time to slowest stage</li>
<li>Pipelining overhead: Pipeline register delay or Clock skew</li>
<li>Clock cycle &gt; clock skew + latch overhead</li>
<li><strong>hazards</strong></li>
</ul>
<h4 id="3-3-Pipeline-Hazards"><a href="#3-3-Pipeline-Hazards" class="headerlink" title="3.3 Pipeline Hazards"></a>3.3 Pipeline Hazards</h4><p>(1) Structural Hazards: 资源冲突。the HW cannot support all possible instruction combinations <strong>simultaneously</strong>.</p>
<p>举例：Some pipelined processors have shared a single memory for data and instructions. you can’t fetch instrcution if now is reading data from memory.</p>
<p>solution: STALLs (aka BUBBLEs) / increase CPI</p>
<p>E.g: PPT 49</p>
<p>2) Data Hazards:上条正在更新的内容还没有写入下一条就要用。an instruction depends on the result of a previous instruction</p>
<p>举例：ADDI follows a SD</p>
<p>solution: Forwading (or bypassing) If the forwarding hardware detects that the previous ALU operation has written the register corresponding to a source for the current ALU operation, control logic selects the forwarded result as the ALU input rather than the value read from the register file.</p>
<p><em>来自EX/MEM和MEM/WB的寄存器的ALU结果被反馈到ALU的输入端。</em></p>
<p>WARNING：Not all Data Hazards can be solved by Forwarding. LD ———- ADDI. should use STALL</p>
<p>(3) Control Hazards: PC的更新及时性。arise from the pipelining of branches, jumps and CPU can’t determine which instruction to take.</p>
<p>举例：Branch (taken? Not taken?)</p>
<p>solution: </p>
<p>​    a. GUESS: if guess wrong, undo the steps (见Lecture05)</p>
<p>​    b. Stalls: </p>
<p>​    c. Use a delayed branch:</p>
<p>​            i. 用没用的指令作为delay slot；</p>
<p>​            ii. 用跳转目的地中无关的内容作为；</p>
<p>​            iii. 用不跳转的部分指令作为。    </p>
<p>​    d. 循环展开+调整指令顺序.</p>
<p>E.g: Write a code that the branch instruction in ID causes a RAW hazard, even with data forwarding.</p>
<p>习题：PPT 64~70（重点！！）</p>
<h3 id="Lecture-04-ILP"><a href="#Lecture-04-ILP" class="headerlink" title="Lecture 04. ILP"></a>Lecture 04. ILP</h3><h4 id="4-1-Instruction-Level-Parallelism"><a href="#4-1-Instruction-Level-Parallelism" class="headerlink" title="4.1 Instruction-Level Parallelism"></a>4.1 Instruction-Level Parallelism</h4><p><strong>ILP</strong>: overlap the execution of instructions</p>
<ul>
<li>partially (through pipelining)</li>
<li>completely (through issuing on multiple functional units)</li>
</ul>
<h4 id="4-2-Dependences-versus-Hazards"><a href="#4-2-Dependences-versus-Hazards" class="headerlink" title="4.2 Dependences versus Hazards"></a>4.2 Dependences versus Hazards</h4><ol>
<li>Dependences are a property of programs.</li>
<li>Based on the given pipeline implementation a data dependency may result in an actual hazard being detected and a possible stall.</li>
<li>Dependency ≡ hazard potential.</li>
<li>Dependences determine the order in which results must be computed.</li>
<li>Dependences set an upper bound on the amount of instruction-level parallelism that can be exploited.</li>
</ol>
<h4 id="4-3-Dependency-Category"><a href="#4-3-Dependency-Category" class="headerlink" title="4.3 Dependency Category"></a>4.3 Dependency Category</h4><ul>
<li>True Data Dependency: may lead to RAW </li>
<li>Name Dependence: <ul>
<li>Anti-dependence: may lead to WAR</li>
<li>output dependence: may lead to WAW</li>
</ul>
</li>
</ul>
<p><em>note: WAW or WAR can be avoided by optimized algorithm, while RAW is the truth dependency that can’t be omitted.</em></p>
<blockquote>
<p>注：这里把我绕晕了。RAW是read after write，意思是“写操作在读操作的前面，但是有可能还没有写完，就开始读”，就会造成冒险。而WAR显然就是写指令在读指令后面，然而有可能还没读完就开始写。这个没理解清楚，后面的两个算法都不懂。</p>
</blockquote>
<h4 id="4-4-The-Scoreboard-Approach"><a href="#4-4-The-Scoreboard-Approach" class="headerlink" title="4.4 The Scoreboard Approach*"></a>4.4 The Scoreboard Approach*</h4><h5 id="4-4-1-Stages"><a href="#4-4-1-Stages" class="headerlink" title="4.4.1 Stages"></a>4.4.1 Stages</h5><ol>
<li>ISSUE: instruction decoding. <em>Check</em> <strong>structural hazards</strong> and <strong>WAW</strong>.</li>
<li>READ OPERANDS: wait for operand. <em>Resolve</em> <strong>RAW hazards</strong></li>
<li>EXECUTION: inform upon completion.</li>
<li>WRITE BACK: <em>Check</em> <strong>WAR hazards</strong></li>
</ol>
<h5 id="4-4-2-Scoreboard-outlook"><a href="#4-4-2-Scoreboard-outlook" class="headerlink" title="4.4.2 Scoreboard outlook"></a>4.4.2 Scoreboard outlook</h5><p><img src="/2020/12/07/arc_notes/image-20201207210159451.png" alt="image-20201207210159451" style="zoom:40%;"></p>
<h5 id="4-4-3-Scoreboard-Explain"><a href="#4-4-3-Scoreboard-Explain" class="headerlink" title="4.4.3 Scoreboard Explain"></a>4.4.3 Scoreboard Explain</h5><p><img src="/2020/12/07/arc_notes/image-20201207210942981.png" alt="image-20201207210942981" style="zoom:60%;"></p>
<h5 id="4-4-4-how-to-avoid"><a href="#4-4-4-how-to-avoid" class="headerlink" title="4.4.4 how to avoid?"></a>4.4.4 how to avoid?</h5><p>在Write阶段，如果目标寄存器是别人的false 可以写（避免了WAR）</p>
<p>在Decode阶段，如果两个都true了可以读（避免了RAW）读完以后设置成false</p>
<p>在Issue阶段，如果目标寄存器没有被别人正在写，可以开始（避免了WAW）</p>
<h3 id="Lecture-05-Dynamic-Branch-Prediction"><a href="#Lecture-05-Dynamic-Branch-Prediction" class="headerlink" title="Lecture 05. Dynamic Branch Prediction"></a>Lecture 05. Dynamic Branch Prediction</h3><p>(复习时，建议先看Lec 06再看05)</p>
<h4 id="5-1-Branch-prediction-strategy"><a href="#5-1-Branch-prediction-strategy" class="headerlink" title="5.1 Branch prediction strategy"></a>5.1 Branch prediction strategy</h4><ul>
<li><p>STATIC (Decided before runtime)</p>
<ul>
<li>Always-Not Taken / Always-Taken</li>
<li>Backwards Taken, Forward Not Taken</li>
</ul>
</li>
<li><p>Dynamic(Prediction decisions may change during the execution of the program)</p>
</li>
</ul>
<h4 id="5-2-1-bit-Predictor"><a href="#5-2-1-bit-Predictor" class="headerlink" title="5.2 1-bit Predictor"></a>5.2 1-bit Predictor</h4><p><em>考试中若出现此题型会给出状态机.</em></p>
<p><img src="/2020/12/07/arc_notes/image-20201208091500097.png" alt="image-20201208091500097" style="zoom:45%;"></p>
<h4 id="5-3-Branch-History-Table"><a href="#5-3-Branch-History-Table" class="headerlink" title="5.3 Branch-History Table"></a>5.3 Branch-History Table</h4><p>Implemented as a small memory indexed by a portion (usually some low-significant bits) of the address of the branch instruction. That means, the buffer stores for each address the prediction result.</p>
<h4 id="5-4-2-bit-Predictor"><a href="#5-4-2-bit-Predictor" class="headerlink" title="5.4 2-bit  Predictor"></a>5.4 2-bit  Predictor</h4><p><img src="/2020/12/07/arc_notes/image-20201208112748770.png" alt="image-20201208112748770"></p>
<p><em>note: 实验指导书的FSM（上图）与PPT中的不一样，具体的还是看题目给的是什么.</em></p>
<p>A 2-bit predictor helps to insist on previous prediction for a longer time. it’s not always better than one bit.</p>
<p>E.g:</p>
<p>A snapshot of the taken/not-taken behavior of a branch is:<br>… T T T T T T T T <strong>N N T T N N T N N T</strong><br>If the branch predictor used is a 2-bit saturating counter, how many of the last ten branches are predicted correctly?</p>
<blockquote>
<p>上图的FSM：ST WT WN WT ST WT WN WT WN SN</p>
<p>PPT 的FSM：ST WT SN WN ST WT SN WN SN SN</p>
</blockquote>
<h4 id="5-5-Correlating-Branch-Predictors"><a href="#5-5-Correlating-Branch-Predictors" class="headerlink" title="5.5 Correlating Branch Predictors"></a>5.5 Correlating Branch Predictors</h4><h5 id="5-5-1-limitations-on-previous-methods"><a href="#5-5-1-limitations-on-previous-methods" class="headerlink" title="5.5.1 limitations on previous methods"></a>5.5.1 limitations on previous methods</h5><p>The 2-bit predictor schemes use only the <strong>recent behavior of a single branch</strong> to predict the future behavior of that branch. Increasing to 3-bit or more does not help much!</p>
<h5 id="5-5-2-Proposal-of-Correlating-Predictor"><a href="#5-5-2-Proposal-of-Correlating-Predictor" class="headerlink" title="5.5.2 Proposal of Correlating Predictor"></a>5.5.2 Proposal of Correlating Predictor</h5><p>An (m,n) 2-level predictor uses the behavior of the last m branches to choose from $2^m$ branch predictors, each of which is an n-bit predictor for a single branch. </p>
<p>e.g</p>
<p>assume that A(1, 1)predictor is initialized as (NT/NT). m=1, n=1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">b1	BNEZ R1, L1 #if(d == 0)</span><br><span class="line">		DADDIU R1, R0, #1 #d = 1</span><br><span class="line">	L1:...</span><br><span class="line">b2	BNEZ R3, L2 #if(d == 1)</span><br><span class="line">		...</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>d=?</th>
<th>b1 pred</th>
<th>b1 action</th>
<th>b1 new pred</th>
<th>b2 pred</th>
<th>b2 action</th>
<th>b2 new pred</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>NT/NT</td>
<td>T</td>
<td>T/NT</td>
<td>NT/<strong>NT</strong></td>
<td>T</td>
<td>NT/T</td>
</tr>
<tr>
<td>0</td>
<td>T/NT</td>
<td>NT</td>
<td>T/NT</td>
<td>NT/T</td>
<td>NT</td>
<td>NT/T</td>
</tr>
<tr>
<td>2</td>
<td>T/NT</td>
<td>T</td>
<td>T/NT</td>
<td>NT/T</td>
<td>T</td>
<td>NT/T</td>
</tr>
<tr>
<td>0</td>
<td>T/NT</td>
<td>NT</td>
<td>T/NT</td>
<td>NT/T</td>
<td>NT</td>
<td>NT/T</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Lecture-06-Tomasulo’s-Algorithm"><a href="#Lecture-06-Tomasulo’s-Algorithm" class="headerlink" title="Lecture 06. Tomasulo’s Algorithm"></a>Lecture 06. Tomasulo’s Algorithm</h3><h4 id="6-1-Main-features"><a href="#6-1-Main-features" class="headerlink" title="6.1 Main features"></a>6.1 Main features</h4><ul>
<li><strong>distributed</strong> control and buffering with reservation stations; （没有集中的控制单元）</li>
<li>dynamically replace register specification in instruction with value or pointer to functional unit producing the value (register renaming);</li>
<li>tracking when operands are available to handle RAWs;</li>
<li>more reservation stations than registers.</li>
</ul>
<h4 id="6-2-Assumption"><a href="#6-2-Assumption" class="headerlink" title="6.2 Assumption"></a>6.2 Assumption</h4><ul>
<li>Distributed control based on reservation station tag fields;</li>
<li>Register file bypassed in broadcasting to reservation stations via Common Data Bus;(使用了总线，当某一个数据计算结束后，结果马上广播给所有要用它的数据单元);</li>
<li>stall issuing operations when there is a pending branch in the pipeline(因为数据的变化在EX执行前通知到各FU即可，所以issue可以照常).</li>
</ul>
<h4 id="6-3-Stages"><a href="#6-3-Stages" class="headerlink" title="6.3 Stages"></a>6.3 Stages</h4><ol>
<li><p>ISSUE</p>
<p>i. check for availability of matching reservation station (structural hazards); </p>
<p>ii. check for operands in the register file and read them if available (register renaming handles <strong>WAR</strong> and <strong>WAW</strong> hazards) </p>
<blockquote>
<p>注意：tomasulo的第一阶段实际上是把scoreboard的1、2阶段结合了。</p>
<p>scoreboard的第一阶段是进行资源冲突检测（即FU是否可用，这样可以避免structrual hazard）以及目标寄存器是否正在为其他在执行指令的目标（避免WAW）</p>
<p>scoreboard的第二阶段是读指令operand里的数据，如果这些数据正在被其他单元操作，就不读，这样可以避免RAW</p>
<p>而不同之处在于，托马索罗有保留站，当时issue进来r1的值会保留在保留站里，后面即使改变了也不要紧，这个指令的单元中r1依旧是之前读出来的值，后续读的都是rename了，不再是之前的了。</p>
</blockquote>
</li>
<li><p>EXECUTION</p>
<p>i. monitor CDB for missing operands;</p>
<p>ii. start execution when operands are available in reservation stations (<strong>RAW</strong> hazards).</p>
</li>
<li><p>WRITE BACK</p>
<p> i. use CDB to broadcast the result to register file and reservation stations ( including store buffers to write memory)</p>
</li>
</ol>
<h4 id="6-4-Explanation-of-T’s-Chart"><a href="#6-4-Explanation-of-T’s-Chart" class="headerlink" title="6.4 Explanation of T’s Chart"></a>6.4 Explanation of T’s Chart</h4><p><img src="/2020/12/07/arc_notes/image-20201208094940662.png" alt="image-20201208094940662"></p>
<ol>
<li>Op:    Operation to perform in the unit (e.g., + or –)</li>
<li>Vj, Vk: <strong>Value</strong> of Source operands (Store buffers has V field, result to be stored)</li>
<li>Qj, Qk: Reservation stations producing source registers (value to be written)<ul>
<li>No ready flags as in Scoreboard; Qj,Qk=0 =&gt; ready</li>
<li>Store buffers only have Qi for RS producing result</li>
</ul>
</li>
<li>A: to hold memory address for load and store instructoins</li>
<li>Busy: Indicates reservation station or FU is busy</li>
</ol>
<h4 id="6-5-Tomasulo-VS-Scoreboard"><a href="#6-5-Tomasulo-VS-Scoreboard" class="headerlink" title="6.5 Tomasulo VS. Scoreboard"></a>6.5 Tomasulo VS. Scoreboard</h4><div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>Tomasulo’s Algorithm</th>
<th>Scoreboard</th>
</tr>
</thead>
<tbody>
<tr>
<td>introduced with</td>
<td>IBM</td>
<td>CDC</td>
</tr>
<tr>
<td>resoures</td>
<td>3 adders, 2mul/div, 6 load, 3 store</td>
<td>7 int units, 4 FP units, 5 mem</td>
</tr>
<tr>
<td>Max window size</td>
<td>14</td>
<td>5</td>
</tr>
<tr>
<td>structural hazards</td>
<td>Issue: not allow to excute if FU is occupied</td>
<td>Issue: not allow to excute if FU is occupied</td>
</tr>
<tr>
<td>WAR hazards</td>
<td>Issue: avoid by register renaming</td>
<td>Write Back</td>
</tr>
<tr>
<td>WAW hazards</td>
<td>Issue: avoid by register renaming</td>
<td>Issue: wait untill last write Register finish.</td>
</tr>
<tr>
<td>Control</td>
<td>based on reservation station</td>
<td>scoreboard control module</td>
</tr>
<tr>
<td>Communication</td>
<td>Broadcasting</td>
<td>buses from/ to register</td>
</tr>
<tr>
<td>RAW hazards</td>
<td>Execute: finish write, read</td>
<td>Decode: register ready, go next instruction</td>
</tr>
</tbody>
</table>
</div>
<h5 id="6-5-1-breif-review-of-SCOREBOARD"><a href="#6-5-1-breif-review-of-SCOREBOARD" class="headerlink" title="6.5.1 breif review of SCOREBOARD"></a>6.5.1 breif review of SCOREBOARD</h5><p>集中控制部件，记录了数据寄存器和多个处理部件状态的变化情况。</p>
<ul>
<li>stages:<ul>
<li>issue: 检查结构冒险（FU冲突）、WAW（本指令目标寄存器不是其它正在执行的目标），如果存在，指令<strong>暂停发射</strong>；</li>
<li>read operand: 检查RAW（本指令要读的寄存器是否是其他正在执行的目标），如果有，<strong>停顿</strong>；</li>
<li>execute：得到结果时，FU通知完成（即总表上最后一个周期记录结果）；</li>
<li>write back：检查WAR，如果写的目标寄存器被别人访问，<strong>暂停</strong>。</li>
</ul>
</li>
<li>pros:<ul>
<li>动态调度方法利用了程序中存在的ILP，通过乱序执行，达到减少RAW造成的停顿周期</li>
</ul>
</li>
<li>cons:<ul>
<li>指令级并行性不高(需要进一步研究开发更多的ILP)</li>
<li>记分牌表项较少(可增加硬件加以解决)</li>
<li>功能单元少(可增加硬件加以解决)</li>
<li>记分牌无法消除WAR和WAW两种相关性</li>
</ul>
</li>
</ul>
<h5 id="6-5-2-breif-review-of-TOMASULO"><a href="#6-5-2-breif-review-of-TOMASULO" class="headerlink" title="6.5.2 breif review of TOMASULO"></a>6.5.2 breif review of TOMASULO</h5><p>寄存器重命名功能由保留站提供，意思是需要的数据结果被放在这个保留站里面，命了名（独此计算单元所有）</p>
<ul>
<li>stages:<ul>
<li>Issue: 检查结构冒险（FU冲突）、WAW（本指令目标寄存器不是其它正在执行的目标）、WAR（可以先读，因为当前读到的结果被存在保留站里了，而寄存器内值的写（改变）不会影响到保存站里的值）；</li>
<li>execute: 检查RAW，若有一个或几个操作数未就绪，等待计算该操作数，同时监控CDB；</li>
<li>write back：广播计算结果（播给等待此结果的保留站）</li>
</ul>
</li>
</ul>
<h5 id="6-5-3-contrast"><a href="#6-5-3-contrast" class="headerlink" title="6.5.3 contrast"></a>6.5.3 contrast</h5><p>相同之处：</p>
<ol>
<li>两者消除RAW的方法都一样，就是动态调度消除RAW。</li>
<li>对于结构冒险，他们都stall。</li>
<li>都是乱序执行。</li>
</ol>
<p>不同之处：</p>
<ol>
<li>scoreboard（以下简称SB）能检测WAW和WAR，检测到了就stall，所以不能消除，但是tomasulo（下称TA）使用了重命名方法，可以消除；</li>
<li>硬件上，TA是一种分布式方法，通过每一个功能单元的保留站消除了waw和war；而SB是集中式的，只有一个记分牌；</li>
<li>写回方式上，TA是用总线CDB直接广播的，不需要经过寄存器；SB要写寄存器，因此可能造成等待结果而停顿WB阶段的现象。</li>
</ol>
<h3 id="Lecture-07-Memory-Hierarchy-Design"><a href="#Lecture-07-Memory-Hierarchy-Design" class="headerlink" title="Lecture 07. Memory Hierarchy Design"></a>Lecture 07. Memory Hierarchy Design</h3><h4 id="7-1-Locality-on-Cache"><a href="#7-1-Locality-on-Cache" class="headerlink" title="7.1 Locality on Cache"></a>7.1 Locality on Cache</h4><ol>
<li>Temporal: cache provides faster access to a smaller subset of the main memory which contains copies that <strong>recently used</strong>.</li>
<li>Spatial: contiguous memory cells is retrieved from the main memory.</li>
</ol>
<h4 id="7-2-Cache-Tech"><a href="#7-2-Cache-Tech" class="headerlink" title="7.2 Cache Tech."></a>7.2 Cache Tech.</h4><h5 id="7-2-1-Concepts-of-cache"><a href="#7-2-1-Concepts-of-cache" class="headerlink" title="7.2.1 Concepts of cache"></a>7.2.1 Concepts of cache</h5><ol>
<li>The most popular scheme is set associative, where a set is a group of blocks.</li>
</ol>
<blockquote>
<p>A set with N blocks is called N-way associative </p>
</blockquote>
<ol>
<li>A block is first mapped onto a set, and then the block can be placed anywhere within that set.</li>
<li><img src="/Users/liqilin/Library/Application Support/typora-user-images/image-20201208171544187.png" alt="image-20201208171544187"></li>
<li>Finding a block consists of first mapping the block address to the set and then searching the set—usually in parallel—to find the block. </li>
</ol>
<h5 id="7-2-2-terminology"><a href="#7-2-2-terminology" class="headerlink" title="7.2.2 terminology"></a>7.2.2 terminology</h5><ul>
<li>Cache hit<ul>
<li>CPU find the requested data item in the cache</li>
</ul>
</li>
<li>Cache Miss<ul>
<li>CPU doesn’t find the requested data item in the cache</li>
</ul>
</li>
<li>Miss panalty<ul>
<li>time to replace a block in the cache (plus time to deliver data item to CPU) </li>
<li>time depends on both latency &amp; bandwidth</li>
<li>handled by hardware that stalls the memory unit (and, therefore, the whole instruction processing in case of simple single-issue uP)</li>
</ul>
</li>
<li>Block</li>
<li>Set</li>
</ul>
<p><img src="/2020/12/07/arc_notes/image-20201208173455175.png" alt="image-20201208173455175" style="zoom:50%;"></p>
<h4 id="7-3-Direct-Mapping"><a href="#7-3-Direct-Mapping" class="headerlink" title="7.3 Direct Mapping"></a>7.3 Direct Mapping</h4><p><img src="/2020/12/07/arc_notes/image-20201208173630145.png" alt="image-20201208173630145" style="zoom:33%;"></p>
<p>Each memory block is mapped to one cache entry.</p>
<p>in direct mapping, <strong>a block is a word.</strong>(4 bytes, normally) so the offset if log(4) = 2</p>
<p>e.g: ppt 32</p>
<p><strong>pros and cons</strong>:</p>
<ul>
<li>Simple, and Inexpensive</li>
<li>Fixed location for given block<ul>
<li>If a program accesses 2 blocks that map to the same line repeatedly, cache misses are very high</li>
</ul>
</li>
</ul>
<p><em>note: offset refers to 字节偏移量!</em></p>
<p>mapping process：先查index，再查tag，最后是block中的offset。</p>
<h4 id="7-4-Fully-Associative"><a href="#7-4-Fully-Associative" class="headerlink" title="7.4 Fully Associative"></a>7.4 Fully Associative</h4><p><img src="/2020/12/07/arc_notes/image-20201208193842341.png" alt="image-20201208193842341" style="zoom:33%;"></p>
<p>Each block of main memory maps to any cache line. CPU chooses which line to map. 没有index，只有tag和block offset。</p>
<p><strong>pros and cons: </strong></p>
<ul>
<li>Full flexibility on determining the location in cache. </li>
<li>Expensive: Every line’s tag is examined for a match; Cache searching gets slow!</li>
</ul>
<h4 id="7-5-Set-Associative-Cache"><a href="#7-5-Set-Associative-Cache" class="headerlink" title="7.5 Set Associative  Cache"></a>7.5 Set Associative  Cache</h4><p><img src="/2020/12/07/arc_notes/image-20201208193922573.png" alt="image-20201208193922573" style="zoom:33%;"></p>
<ol>
<li><p>Cache is organized into sets where each set has 2, 4, 8 or more blocks: </p>
<ul>
<li>Each block is mapped to a set, and can <strong>be placed anywhere</strong> in that set. </li>
<li>The cache using m blocks per set is called m-way cache. </li>
<li>The number of sets is: L/m. Hence the set index is lg(L)-lg(m);</li>
<li>It is a trade-off between Direct Map (1-way) and Full Associative Map (All-way). </li>
</ul>
</li>
<li><p>When we place a block to a cache line, the block address is split into two parts:</p>
<p>(1) The LSB of lg(L)-lg(m) bits in block address tells the cache set the block maps to.</p>
<p>(2) The rest MSB bits, N-lg(w)-lg(L)-lg(m) in block address becomes its tag. </p>
</li>
</ol>
<p><em>note: the finding process is, 先找set index，再用tag匹配block块，再用block offset看是在block中的哪一个byte。</em></p>
<p>e.g: We will use the following architecture:</p>
<p>Cache of 64 kByte, cache block of 4 bytes, 16MBytes main memory and 24 bit address fro the cache. tell the bit number of tag, index and offset in direct map, 2 set associative and fully associative.</p>
<script type="math/tex; mode=display">
block\ num = 64\ kBytes / 4\ bytes=2^{14}</script><script type="math/tex; mode=display">
offset=lg(W)+lg(w/W)=lg(W)=lg(4)=2</script><p>1.direct map:</p>
<script type="math/tex; mode=display">
index = lg(block\ num) = 14</script><script type="math/tex; mode=display">
tag=len(addr)-index-offset=24-2-14=8</script><p>2.fully associative:</p>
<script type="math/tex; mode=display">
index=0(no\ index \ for \ fully \ associative)</script><script type="math/tex; mode=display">
tag = 24 - 2 = 22</script><p>3.2-set associative:</p>
<script type="math/tex; mode=display">
set\ index = lg(block\ num/set) = 13</script><script type="math/tex; mode=display">
tag=24-13-2=9</script><h4 id="7-6-A-Continuum"><a href="#7-6-A-Continuum" class="headerlink" title="7.6 A Continuum"></a>7.6 A Continuum</h4><ul>
<li>Direct Mapping gives fastest hit times, best for very large caches.</li>
<li>Full associativity gives lowest miss rate, best when miss penalty is very high</li>
<li>Increasing degree of associativity<ul>
<li>Typically decreases miss rate</li>
<li>increases hit time  (due to extra comparison/selection)</li>
<li>design trade-off between miss penalty and area/time overhead</li>
<li>tag变长，index变短。</li>
</ul>
</li>
</ul>
<p>e.g2: Quiz 4</p>
<h4 id="7-7-Cache-Write-Policies"><a href="#7-7-Cache-Write-Policies" class="headerlink" title="7.7 Cache Write Policies"></a>7.7 Cache Write Policies</h4><h5 id="7-7-1-policy"><a href="#7-7-1-policy" class="headerlink" title="7.7.1 policy"></a>7.7.1 policy</h5><ol>
<li>write back (write only cache block and set a “dirty bit” as reminder)<br>   – uses less memory bandwidth and it is a low-power approach</li>
<li><p>write through (write block on cache and memory simultaneously)</p>
<pre><code>      – requires a write buffer to minimize write stall
</code></pre></li>
<li><p>write allocation：在写memory后是否为之在cache中分配位置</p>
<blockquote>
<ul>
<li>Write Allocate (typically used by write-back caches)</li>
<li>No-Write Allocate (typically used by write-through caches)</li>
</ul>
</blockquote>
</li>
</ol>
<p><em>note：看两个状态机！</em></p>
<p><em>note2：cache在读入的时候是读一块数据（为了保持局部性），写入的时候是写一个。这一点在写分配中也有体现。</em></p>
<h5 id="7-7-2-comparison"><a href="#7-7-2-comparison" class="headerlink" title="7.7.2 comparison"></a>7.7.2 comparison</h5><div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>write-back</th>
<th>write-through</th>
</tr>
</thead>
<tbody>
<tr>
<td>pros</td>
<td>+ writes occur at the speed of the cache memory</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>multiple writes within a block require only one write to the lower-level memory</li>
<li>some writes don’t go to memory | + easier to implement than write back</li>
<li>cache is always clean, so read misses are faster as they never result in writes to lower level </li>
<li>next lower level has the most current copy of the data |<br>| cons | 如果某一时间断电，数据可能会丢失                可信度比较低 | 如果miss，采用不分配没有放回cache，写回的优势没有发挥出来    |</li>
</ul>
<h4 id="7-8-Cache-Performance"><a href="#7-8-Cache-Performance" class="headerlink" title="7.8 Cache Performance"></a>7.8 Cache Performance</h4><script type="math/tex; mode=display">
CPU\ execution \ time=(CPU\ clock\ cycles+Memory\ stall\ cycles)\times CCT</script><h5 id="7-8-1-Memory-stall-cycles"><a href="#7-8-1-Memory-stall-cycles" class="headerlink" title="7.8.1 Memory stall cycles"></a>7.8.1 Memory stall cycles</h5><ul>
<li>IC: Instruction Count. </li>
<li>Memory Accesses: <ul>
<li>Each instr. has at least 1 memory access – loading the instr. </li>
<li>Some may have a data access</li>
</ul>
</li>
<li>Miss Rate: the fraction of cache accesses that result in a miss </li>
<li>Miss Penalty: an average # of stall cycles needed for a miss. </li>
</ul>
<p><img src="/2020/12/07/arc_notes/image-20201208205949463.png" alt="image-20201208205949463"></p>
<p>E.g: PPT 70 </p>
<h5 id="7-8-2-Average-memory-access-time"><a href="#7-8-2-Average-memory-access-time" class="headerlink" title="7.8.2 Average memory access time"></a>7.8.2 Average memory access time</h5><p><img src="/2020/12/07/arc_notes/arc_notesimage-20201208214021425.png" alt="image-20201208214021425" style="zoom:35%;"></p>

    </article>
    <!-- license -->
    
    <!-- paginator -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/2021/01/28/Eye-Gaze-Estimation-md/" title="Eye Gaze Estimation">
                    <div class="nextTitle">Eye Gaze Estimation</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/2020/11/01/network_notes/" title="2020秋季《计算机网络》笔记">
                    <div class="prevTitle">2020秋季《计算机网络》笔记</div>
                </a>
            
        </li>
    </ul>
    <!-- comment -->
    
        <div class="post-comment">
            <!-- 来必力 City 版安装代码 -->


            

            

            

            <!-- utteranc评论 -->


            <!-- partial('_partial/comment/changyan') -->
            <!--PC版-->


            
            
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <div id="comment"></div>
    <script>
        new Valine({
            el: '#comment',
            notify:false,
            verify:false,
            appId: "rqg8nF0IPUhLEfImp7Bt6otS-gzGzoHsz",
            appKey: "lMlsrNdpsnqO9tvxuu2oloUW",
            placeholder: "请说",
            path:window.location.pathname,
            avatar:'mm'
        });
    </script>


            

        </div>
    
    <!-- timeliness note -->
    <!-- idea from: https://hexo.fluid-dev.com/posts/hexo-injector/#%E6%96%87%E7%AB%A0%E6%97%B6%E6%95%88%E6%80%A7%E6%8F%90%E7%A4%BA -->
    
    <!-- Mathjax -->
    
        
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        };
    </script>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>


    
</main>

                <!-- profile -->
                
            </div>
            <footer class="footer footer-unloaded">
    <!-- social  -->
    
        <div class="social">
            
    
        
            
                <a href="mailto:xslialee070@outlook.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/SiciliaLeco" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
            
                <span class="iconfont-archer wechat" title=wechat>
                    
                    <img class="profile-qr" src="/assets/qr.jpeg" />
                </span>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    


        </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- website approve for Chinese user -->
    
    <!-- 不蒜子  -->
    
        <div class="busuanzi-container">
            
             
                <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
            
        </div>
    	
</footer>

        </div>
        <!-- toc -->
        
            <div class="toc-wrapper toc-wrapper-loding" style=







    top:50vh;

>
                <div class="toc-catalog">
                    <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
                </div>
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Computer-Architecture-Course-Review"><span class="toc-number">1.</span> <span class="toc-text">Computer Architecture Course Review</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Leture-01-Quantitative-Approach"><span class="toc-number">1.1.</span> <span class="toc-text">Leture 01. Quantitative Approach</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-Power-And-Energy"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 Power And Energy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-1-introduction"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">1.1.1 introduction</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-2-dynamic-energy-and-power"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">1.1.2 dynamic energy and power</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-Performance-Metrics"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 Performance Metrics</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-Principle-of-Locality"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 Principle of Locality</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-Amdahl%E2%80%99s-Law"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.4 Amdahl’s Law</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-CPU-Time"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.5 CPU Time</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lecture02-Instruction-Set-Architecture"><span class="toc-number">1.2.</span> <span class="toc-text">Lecture02. Instruction Set Architecture</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-Operand-Storage"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 Operand Storage</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-Kinds-of-Addressing-Mode"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 Kinds of Addressing Mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-MIPS"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 MIPS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-1-Overview"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">2.3.1 Overview</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-2-Instruction-format"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">2.3.2 Instruction format</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-3-MIPS-addressing-mode"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">2.3.3 MIPS addressing mode</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-Interpreting-Memory-Addressing"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 Interpreting Memory Addressing</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lecture-03-Pipelining"><span class="toc-number">1.3.</span> <span class="toc-text">Lecture 03. Pipelining</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-Pipelining-processing"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 Pipelining processing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-Design-Issues"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 Design Issues</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-1-Performance-issue"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">3.2.1 Performance issue</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-2-Performance-Limitation"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">3.2.2 Performance Limitation</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-Pipeline-Hazards"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 Pipeline Hazards</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lecture-04-ILP"><span class="toc-number">1.4.</span> <span class="toc-text">Lecture 04. ILP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-Instruction-Level-Parallelism"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 Instruction-Level Parallelism</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-Dependences-versus-Hazards"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 Dependences versus Hazards</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-Dependency-Category"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 Dependency Category</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-The-Scoreboard-Approach"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4 The Scoreboard Approach*</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-4-1-Stages"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">4.4.1 Stages</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-4-2-Scoreboard-outlook"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">4.4.2 Scoreboard outlook</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-4-3-Scoreboard-Explain"><span class="toc-number">1.4.4.3.</span> <span class="toc-text">4.4.3 Scoreboard Explain</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-4-4-how-to-avoid"><span class="toc-number">1.4.4.4.</span> <span class="toc-text">4.4.4 how to avoid?</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lecture-05-Dynamic-Branch-Prediction"><span class="toc-number">1.5.</span> <span class="toc-text">Lecture 05. Dynamic Branch Prediction</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-Branch-prediction-strategy"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 Branch prediction strategy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-1-bit-Predictor"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 1-bit Predictor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-Branch-History-Table"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3 Branch-History Table</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-2-bit-Predictor"><span class="toc-number">1.5.4.</span> <span class="toc-text">5.4 2-bit  Predictor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-Correlating-Branch-Predictors"><span class="toc-number">1.5.5.</span> <span class="toc-text">5.5 Correlating Branch Predictors</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-5-1-limitations-on-previous-methods"><span class="toc-number">1.5.5.1.</span> <span class="toc-text">5.5.1 limitations on previous methods</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-5-2-Proposal-of-Correlating-Predictor"><span class="toc-number">1.5.5.2.</span> <span class="toc-text">5.5.2 Proposal of Correlating Predictor</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lecture-06-Tomasulo%E2%80%99s-Algorithm"><span class="toc-number">1.6.</span> <span class="toc-text">Lecture 06. Tomasulo’s Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-Main-features"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 Main features</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-Assumption"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 Assumption</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-Stages"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3 Stages</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-Explanation-of-T%E2%80%99s-Chart"><span class="toc-number">1.6.4.</span> <span class="toc-text">6.4 Explanation of T’s Chart</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-Tomasulo-VS-Scoreboard"><span class="toc-number">1.6.5.</span> <span class="toc-text">6.5 Tomasulo VS. Scoreboard</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#6-5-1-breif-review-of-SCOREBOARD"><span class="toc-number">1.6.5.1.</span> <span class="toc-text">6.5.1 breif review of SCOREBOARD</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-5-2-breif-review-of-TOMASULO"><span class="toc-number">1.6.5.2.</span> <span class="toc-text">6.5.2 breif review of TOMASULO</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-5-3-contrast"><span class="toc-number">1.6.5.3.</span> <span class="toc-text">6.5.3 contrast</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lecture-07-Memory-Hierarchy-Design"><span class="toc-number">1.7.</span> <span class="toc-text">Lecture 07. Memory Hierarchy Design</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-Locality-on-Cache"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 Locality on Cache</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2-Cache-Tech"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 Cache Tech.</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#7-2-1-Concepts-of-cache"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">7.2.1 Concepts of cache</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-2-2-terminology"><span class="toc-number">1.7.2.2.</span> <span class="toc-text">7.2.2 terminology</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3-Direct-Mapping"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.3 Direct Mapping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-4-Fully-Associative"><span class="toc-number">1.7.4.</span> <span class="toc-text">7.4 Fully Associative</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-5-Set-Associative-Cache"><span class="toc-number">1.7.5.</span> <span class="toc-text">7.5 Set Associative  Cache</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-6-A-Continuum"><span class="toc-number">1.7.6.</span> <span class="toc-text">7.6 A Continuum</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-7-Cache-Write-Policies"><span class="toc-number">1.7.7.</span> <span class="toc-text">7.7 Cache Write Policies</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#7-7-1-policy"><span class="toc-number">1.7.7.1.</span> <span class="toc-text">7.7.1 policy</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-7-2-comparison"><span class="toc-number">1.7.7.2.</span> <span class="toc-text">7.7.2 comparison</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-8-Cache-Performance"><span class="toc-number">1.7.8.</span> <span class="toc-text">7.8 Cache Performance</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#7-8-1-Memory-stall-cycles"><span class="toc-number">1.7.8.1.</span> <span class="toc-text">7.8.1 Memory stall cycles</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-8-2-Average-memory-access-time"><span class="toc-number">1.7.8.2.</span> <span class="toc-text">7.8.2 Average memory access time</span></a></li></ol></li></ol></li></ol></li></ol>
            </div>
        
        <!-- sidebar -->
        <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
        <div class="sidebar-panel-archives">
    <!-- 在 ejs 中将 archive 按照时间排序 -->
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 13
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
        
            
            
            <div class="archive-year"> 2022 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/28</span>
            <a class="archive-post-title" href="/2022/03/28/MBPfix/">MacBook Pro 2019维修全过程记录</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/05</span>
            <a class="archive-post-title" href="/2022/03/05/nudf/">Neural Unsigned Distance Field 解读</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/21</span>
            <a class="archive-post-title" href="/2022/02/21/Feature-metrics%20Registration%E4%BB%A3%E7%A0%81%E8%A7%A3%E8%AF%BB/">Feature-metrics Registration 解读</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/07</span>
            <a class="archive-post-title" href="/2022/02/07/KMP%E7%AE%97%E6%B3%95/">KMP算法解读和实现</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/03</span>
            <a class="archive-post-title" href="/2022/01/03/Correspondence-Free/">Correspondence-Free Point Cloud Registration  阅读笔记</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2021 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/26</span>
            <a class="archive-post-title" href="/2021/12/26/Torch,-CUDA%E7%89%88%E6%9C%AC%E5%8C%B9%E9%85%8D%E4%BB%A5%E5%8F%8A%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE/">Torch, CUDA版本匹配以及实验室服务器配置</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span>
            <a class="archive-post-title" href="/2021/12/21/Point-Cloud-Registration-md/">Deep Closes Point 阅读笔记</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span>
            <a class="archive-post-title" href="/2021/12/15/Deep-Global-Registration/">Deep Global Registration 阅读笔记</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/02</span>
            <a class="archive-post-title" href="/2021/11/02/%E4%BD%BF%E7%94%A8CMake-%E7%BC%96%E8%AF%91%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9D%97%E5%87%BA%E7%8E%B0Fatal-Error/">使用CMake 编译深度学习模块出现Fatal Error</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/01</span>
            <a class="archive-post-title" href="/2021/11/01/MacOS%E4%B8%8B%E4%BD%BF%E7%94%A8XQuartz-%E8%BF%9E%E6%8E%A5Linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2/">MacOS下使用XQuartz 连接Linux服务器的图形化界面</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/28</span>
            <a class="archive-post-title" href="/2021/01/28/Eye-Gaze-Estimation-md/">Eye Gaze Estimation</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2020 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/07</span>
            <a class="archive-post-title" href="/2020/12/07/arc_notes/">2020秋季《计算机体系结构》笔记</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/01</span>
            <a class="archive-post-title" href="/2020/11/01/network_notes/">2020秋季《计算机网络》笔记</a>
        </li>
    
    </div>
</div>

        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
        
            <span class="sidebar-tag-name" data-tags="Computer Graphics">
                <span class="iconfont-archer">&#xe606;</span>
                Computer Graphics
            </span>
        
            <span class="sidebar-tag-name" data-tags="Computer Vision">
                <span class="iconfont-archer">&#xe606;</span>
                Computer Vision
            </span>
        
            <span class="sidebar-tag-name" data-tags="Research">
                <span class="iconfont-archer">&#xe606;</span>
                Research
            </span>
        
            <span class="sidebar-tag-name" data-tags="LeetCode">
                <span class="iconfont-archer">&#xe606;</span>
                LeetCode
            </span>
        
            <span class="sidebar-tag-name" data-tags="Algorithm">
                <span class="iconfont-archer">&#xe606;</span>
                Algorithm
            </span>
        
            <span class="sidebar-tag-name" data-tags="Linux">
                <span class="iconfont-archer">&#xe606;</span>
                Linux
            </span>
        
            <span class="sidebar-tag-name" data-tags="MacOS">
                <span class="iconfont-archer">&#xe606;</span>
                MacOS
            </span>
        
            <span class="sidebar-tag-name" data-tags="PyTorch">
                <span class="iconfont-archer">&#xe606;</span>
                PyTorch
            </span>
        
            <span class="sidebar-tag-name" data-tags="Computer Architecture">
                <span class="iconfont-archer">&#xe606;</span>
                Computer Architecture
            </span>
        
            <span class="sidebar-tag-name" data-tags="Computer Networks">
                <span class="iconfont-archer">&#xe606;</span>
                Computer Networks
            </span>
        
            <span class="sidebar-tag-name" data-tags="CMake">
                <span class="iconfont-archer">&#xe606;</span>
                CMake
            </span>
        
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
        缺失模块，请参考主题文档进行安装配置：https://github.com/fi3ework/hexo-theme-archer#%E5%AE%89%E8%A3%85%E4%B8%BB%E9%A2%98
    </div> 
    <div class="sidebar-tags-list"></div>
</div>

        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="Literature Review">
            <span class="iconfont-archer">&#xe60a;</span>
            Literature Review
        </span>
    
        <span class="sidebar-category-name" data-categories="Notes">
            <span class="iconfont-archer">&#xe60a;</span>
            Notes
        </span>
    
        <span class="sidebar-category-name" data-categories="Solutions">
            <span class="iconfont-archer">&#xe60a;</span>
            Solutions
        </span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>

    </div>
</div>

        <!-- site-meta -->
        <script>
    var siteMetaRoot = "/"
    if (siteMetaRoot === "undefined") {
        siteMetaRoot = '/'
    }
    var siteMeta = {
        url: "http://example.com",
        root: siteMetaRoot,
        author: "Sicilia Lee (李颀琳）"
    }
</script>

        <!-- import experimental options here -->
        <!-- Custom Font -->


        <!-- main func -->
        <script src="/scripts/main.js?v=20211217"></script>
        <!-- dark mode -->
        <script src="/scripts/dark.js?v=20211217"></script>
        <!-- fancybox -->
        <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script>
        <!-- algolia -->
        
        <!-- busuanzi -->
        
            <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
        
        <!-- CNZZ -->
        
        <!-- async load share.js -->
        
            <script src="/scripts/share.js?v=20211217" async></script>
        
        <!-- mermaid -->
        
    </body>
</html>
